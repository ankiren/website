---
title: "US-6.1: Skill Management (Admin)"
epic: Skill Management
status: Ready
priority: Critical
github_issue: ""
---

# US-6.1: Skill Management (Admin)

## Description

As an **administrator**,
I want to **create, edit, and delete skills with hierarchical structure**,
So that **users can track their proficiency for these skills**.

---

## Acceptance Criteria

| AC | Title | Description |
|----|-------|-------------|
| AC-6.1.1 | View Skills List | Admin can view all skills in Tree or Grid view |
| AC-6.1.2 | View Skill Detail | Admin can view detailed information of a skill |
| AC-6.1.3 | Create New Skill | Admin can create skills with name, description, icon, color, and parent |
| AC-6.1.4 | Edit Skill | Admin can edit all skill properties including parent |
| AC-6.1.5 | Delete Skill | Admin can delete skills (cascade to sub-skills) |
| AC-6.1.6 | Skill Hierarchy | Skills support parent-child relationships |
| AC-6.1.7 | Search Skills | Admin can search for skills by name |

---

### AC-6.1.1: View Skills List

```gherkin
Scenario: View all skills in Tree view
  Given I am logged in as an Admin
  When I navigate to "/admin/skills"
  Then I should see a list of all skills organized in a tree structure
  And each skill should display its icon, name, and description
  And parent skills should show the count of sub-skills
  And I should see the Tree view as the default view

Scenario: View all skills in Grid view
  Given I am logged in as an Admin
  And I am on the skills management page
  When I click the "Grid" toggle button
  Then I should see all skills displayed as cards
  And each card should show icon, name, description, and sub-skill tags
  And cards should be organized in a responsive grid layout

Scenario: Switch between Tree and Grid views
  Given I am viewing skills in Tree view
  When I click the "Grid" toggle button
  Then skills should display in Grid view
  When I click the "Tree" toggle button
  Then skills should display in Tree view
  And the view preference should persist
```

### AC-6.1.2: View Skill Detail

```gherkin
Scenario: View skill detail page
  Given I am logged in as an Admin
  And a skill "Reading" exists under "English"
  When I click on "Reading" in the skills list
  Then I should navigate to "/admin/skills/2"
  And I should see a hero section with:
    | Element        | Value                                   |
    | Icon           | Large icon with gradient background     |
    | Name           | "Reading"                               |
    | Description    | "Understand written texts..."           |
    | Parent badge   | "English" clickable badge               |
  And I should see quick stats:
    | Stat              | Example      |
    | Direct sub-skills | 2            |
    | Total in tree     | 5            |
    | Level depth       | Level 2      |

Scenario: View breadcrumb navigation
  Given I am viewing skill detail for "Comprehension" under "Reading" under "English"
  Then I should see breadcrumb: Skills > English > Reading > Comprehension
  When I click on "Reading" in the breadcrumb
  Then I should navigate to the "Reading" skill detail page

Scenario: View sub-skills on detail page
  Given I am viewing skill detail for "English" with 4 sub-skills
  Then I should see a "Sub-skills" section
  And I should see 4 sub-skill cards in a 2-column grid
  And each card should show icon, name, description, and child count
  When I click on a sub-skill card
  Then I should navigate to that sub-skill's detail page

Scenario: View leaf skill (no sub-skills)
  Given I am viewing skill detail for "Vocabulary" with no sub-skills
  Then I should see an empty state message "No Sub-skills Yet"
  And I should see message "This is a leaf skill with no children"

Scenario: View skill path sidebar
  Given I am viewing skill detail for "Vocabulary" at level 3
  Then I should see a "Skill Path" card in the sidebar
  And I should see the path: English > Reading > Vocabulary
  And the current skill should be highlighted with "Current" badge
  When I click on a parent in the skill path
  Then I should navigate to that skill's detail page

Scenario: Access actions from detail page
  Given I am viewing skill detail for "Reading"
  Then I should see an "Actions" card in the sidebar
  And I should see "Edit Skill" button with gradient background
  And I should see "Delete Skill" button with red styling
  When I click "Edit Skill"
  Then the Edit Skill modal should open with current values

Scenario: Edit skill from detail page
  Given I am viewing skill detail for "Reading"
  When I click "Edit Skill" button
  Then I should see the Edit modal with:
    | Field       | Current Value                  |
    | Name        | "Reading"                      |
    | Description | "Understand written texts..."  |
    | Color       | Current color selected         |
  When I update the name to "Reading Comprehension"
  And I click "Save Changes"
  Then the modal should close
  And the skill name should update to "Reading Comprehension"

Scenario: Delete skill from detail page
  Given I am viewing skill detail for "Draft Skill"
  When I click "Delete Skill" button
  Then I should see the Delete confirmation modal
  When I confirm deletion
  Then I should be redirected to the skills list page
  And the skill should be removed

Scenario: View non-existent skill
  Given I am logged in as an Admin
  When I navigate to "/admin/skills/999" (non-existent ID)
  Then I should see "Skill Not Found" message
  And I should see "The skill you're looking for doesn't exist"
  And I should see "Back to Skills" button
  When I click "Back to Skills"
  Then I should navigate to the skills list page
```

### AC-6.1.3: Create New Skill

```gherkin
Scenario: Create a root skill with all properties
  Given I am logged in as an Admin
  And I am on the skills management page
  When I click "Add Skill" button
  Then I should see the "Create New Skill" modal
  When I enter skill name "English"
  And I enter description "Master reading, writing, listening, and speaking skills"
  And I select parent skill as "None (Root Level)"
  And I select a color from the color picker
  And I search for "Languages" in the icon picker
  And I select the "Languages" icon
  And I click "Create" button
  Then the skill "English" should be created as a root skill
  And the skill should display with the selected icon and color

Scenario: Create a sub-skill
  Given I am logged in as an Admin
  And a root skill "English" exists
  When I click "Add Skill" button
  And I enter skill name "Reading"
  And I enter description "Understand written texts and extract meaning"
  And I search for "English" in the parent skill dropdown
  And I select "English" as parent skill
  And I select the "BookOpen" icon
  And I click "Create" button
  Then the skill "Reading" should be created under "English"
  And I should see it as a child in the skill tree

Scenario: Use icon picker with categories
  Given I am in the Create Skill modal
  When I click on the icon category dropdown
  Then I should see categories like "Accessibility", "Animals", "Arrows", etc.
  When I select "Communication" category
  Then I should only see icons from that category
  When I search for "book" in the icon search
  Then I should see icons matching "book" in name or tags
  When I click "Load more" button
  Then I should see additional icons loaded
```

### AC-6.1.4: Edit Skill

```gherkin
Scenario: Edit skill properties
  Given I am logged in as an Admin
  And a skill "Readng" exists with typo
  When I navigate to the skill detail page
  And I click the "Edit" button
  Then I should see the Edit Skill modal with current values
  When I change the name to "Reading"
  And I update the description
  And I change the icon to "BookOpen"
  And I change the color
  And I click "Save" button
  Then all skill properties should be updated
  And the skill should display with new values

Scenario: Move skill to different parent
  Given I am logged in as an Admin
  And a skill "Vocabulary" exists under "English"
  And a skill "Japanese" exists as root
  When I edit "Vocabulary" skill
  And I search for "Japanese" in the parent dropdown
  And I change parent to "Japanese"
  And I click "Save" button
  Then "Vocabulary" should now be under "Japanese"
  And it should no longer appear under "English"

Scenario: Promote skill to root level
  Given I am logged in as an Admin
  And a skill "Grammar" exists under "English"
  When I edit "Grammar" skill
  And I select "None (Root Level)" as parent
  And I click "Save" button
  Then "Grammar" should become a root skill
```

### AC-6.1.5: Delete Skill

```gherkin
Scenario: Delete skill without sub-skills
  Given I am logged in as an Admin
  And a skill "Draft Skill" exists with no sub-skills
  When I click the delete button for "Draft Skill"
  Then I should see a confirmation dialog asking "Delete Draft Skill?"
  When I click "Delete" button
  Then the skill should be deleted
  And it should no longer appear in the skill list

Scenario: Delete skill with sub-skills (cascade)
  Given I am logged in as an Admin
  And a skill "English" has 4 sub-skills
  When I click the delete button for "English"
  Then I should see a warning "This will also delete 4 sub-skill(s)"
  When I confirm the deletion
  Then "English" and all its sub-skills should be deleted

Scenario: Cancel skill deletion
  Given I am logged in as an Admin
  And I click the delete button for a skill
  When I click "Cancel" button
  Then the deletion should be cancelled
  And the skill should remain unchanged
```

### AC-6.1.6: Skill Hierarchy

```gherkin
Scenario: View skill tree with multiple levels
  Given I am logged in as an Admin
  And the following skill hierarchy exists:
    | Skill         | Parent     | Icon         |
    | English       | (root)     | Languages    |
    | Reading       | English    | BookOpen     |
    | Comprehension | Reading    | Brain        |
    | Vocabulary    | Reading    | BookA        |
    | Listening     | English    | Headphones   |
  When I view the skills management page in Tree view
  Then I should see "English" as a root skill with badge "(4)"
  And clicking on "English" should expand to show "Reading" and "Listening"
  And clicking on "Reading" should expand to show "Comprehension" and "Vocabulary"
  And tree lines should connect parent to children

Scenario: Navigate to skill detail from tree
  Given I am viewing the skill tree
  When I click on "Reading" skill item
  Then I should navigate to "/admin/skills/2" (skill detail page)
  And I should see full details for "Reading" skill
```

### AC-6.1.7: Search Skills

```gherkin
Scenario: Search skills by name
  Given I am logged in as an Admin
  And multiple skills exist
  When I type "read" in the search box
  Then I should only see skills containing "read" in their name
  And the tree structure should be preserved (showing parent paths)
  And matching skills should be highlighted

Scenario: Search with no results
  Given I am logged in as an Admin
  When I type "xyz123" in the search box
  Then I should see an empty state message "No skills found"
  And I should see suggestion "Try adjusting your search or add a new skill"

Scenario: Clear search
  Given I have searched for "English"
  When I clear the search box
  Then all skills should be displayed again
```

---

## Technical Notes

### Skill Schema

```typescript
interface Skill {
  id: number;
  name: string;              // Required, 2-100 characters
  description?: string;      // Optional, max 500 characters
  icon?: string;             // Lucide icon name, default "FileText"
  color?: number;            // Color index 0-9, default 0
  parentId: number | null;   // null for root skills
  children?: Skill[];        // Populated in tree queries
  createdAt: string;
  updatedAt: string;
  createdBy: string;
}
```

### Color Options

| Index | Name    | Class           |
|-------|---------|-----------------|
| 0     | Violet  | bg-violet-500   |
| 1     | Blue    | bg-blue-500     |
| 2     | Emerald | bg-emerald-500  |
| 3     | Orange  | bg-orange-500   |
| 4     | Pink    | bg-pink-500     |
| 5     | Indigo  | bg-indigo-500   |
| 6     | Cyan    | bg-cyan-500     |
| 7     | Rose    | bg-rose-500     |
| 8     | Amber   | bg-amber-500    |
| 9     | Teal    | bg-teal-500     |

### Icon System

- Uses Lucide React icons (1665+ icons)
- Icons organized into 43 categories
- Search by icon name, tags, or category
- Default icon: "FileText"
- Icon picker shows 100 icons initially with "Load more" pagination

### Implementation

- **Page**: `src/app/admin/skills/page.tsx` - Skills management with Tree/Grid toggle
- **Detail Page**: `src/app/admin/skills/[id]/page.tsx` - Skill detail with edit/delete
- **API**: `src/app/api/admin/skills/route.ts` - CRUD endpoints
- **Shared**: `src/app/demo/skills/_shared.tsx` - Types, mock data, SkillIcon component

### Database

```sql
-- Skills table
CREATE TABLE Skills (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  description TEXT,
  icon TEXT DEFAULT 'FileText',
  color INTEGER DEFAULT 0,
  parent_id INTEGER REFERENCES Skills(id) ON DELETE CASCADE,
  created_by TEXT NOT NULL,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- Create root skill
INSERT INTO Skills (name, description, icon, color, parent_id, created_by)
VALUES ('English', 'Master reading, writing, listening, and speaking skills', 'Languages', 0, NULL, :adminId);

-- Create sub-skill
INSERT INTO Skills (name, description, icon, color, parent_id, created_by)
VALUES ('Reading', 'Understand written texts', 'BookOpen', 0, :parentId, :adminId);

-- Update skill
UPDATE Skills
SET name = :name, description = :description, icon = :icon, color = :color, parent_id = :parentId, updated_at = CURRENT_TIMESTAMP
WHERE id = :id;

-- Delete skill (cascade deletes children)
DELETE FROM Skills WHERE id = :id;
```

### API Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/admin/skills` | List all skills as tree |
| GET | `/api/admin/skills/:id` | Get skill details |
| POST | `/api/admin/skills` | Create new skill |
| PUT | `/api/admin/skills/:id` | Update skill |
| DELETE | `/api/admin/skills/:id` | Delete skill (cascade) |

### Request/Response Examples

**Create Skill:**
```json
POST /api/admin/skills
{
  "name": "Reading",
  "description": "Understand written texts and extract meaning",
  "icon": "BookOpen",
  "color": 1,
  "parentId": 1
}
```

**Update Skill:**
```json
PUT /api/admin/skills/2
{
  "name": "Reading Comprehension",
  "description": "Updated description",
  "icon": "Brain",
  "color": 2,
  "parentId": 1
}
```

### Error Handling

| Error | HTTP Status | Message |
|-------|-------------|---------|
| Skill not found | 404 | "Skill not found" |
| Invalid parent | 400 | "Parent skill not found" |
| Circular reference | 400 | "Cannot set skill as its own parent or descendant" |
| Name required | 400 | "Skill name is required" |

---

## UI Components

### View Toggle
- Two buttons: "Tree" and "Grid"
- Selected view has white background with shadow
- Toggle updates URL query param (`?view=grid`)
- Preference persisted in localStorage

### Create/Edit Modal
- **Size**: Large (`size="lg"`)
- **Fields**:
  1. Skill Name (text input, required)
  2. Description (textarea, 2 rows)
  3. Parent Skill (searchable dropdown with "None (Root Level)" option)
  4. Color (10 color swatches)
  5. Icon (icon picker with preview, search, category filter, pagination)
- **Actions**: Create/Save + Cancel buttons

### Delete Modal
- **Size**: Small (`size="sm"`)
- Warning icon (red circle)
- Skill name displayed
- Warning message for sub-skills if applicable
- Delete (red) + Cancel buttons

---

## RICE Score

| Factor | Value | Rationale |
|--------|-------|-----------|
| Reach | 50% | Foundation for all skill tracking |
| Impact | 3 (Massive) | Required for entire feature |
| Confidence | 90% | Demo approved and validated |
| Effort | 1 week | API + UI + tree component |

**Score:** (50 × 3 × 0.9) / 1 = **135**
